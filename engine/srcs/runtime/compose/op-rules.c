#include "xre_nodes.h"
#include "xre_runtime.h"

const struct op_meta op_meta_lookup[] = {
	{ __VARIABLE__,
	  O_TYPE_UNDEFINED | O_ATTR_MUTABLE,
	  O_TYPE_NONE,
	  O_TYPE_NONE },
	{ __BUILTIN_CALL__,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __SCOPE_RESOLUTION__,
	  O_BR_RESULT_LEFT | O_ATTR_READABLE | O_ATTR_MUTABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE | O_ATTR_MUTABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __VAL__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NONE,
	  O_TYPE_NONE },
	{ __STRING_LITERAL__,
	  O_TYPE_STRING | O_ATTR_READABLE,
	  O_TYPE_NONE,
	  O_TYPE_NONE },
	{ __LBRACK__, O_TYPE_NONE, O_TYPE_NONE, O_TYPE_NONE },
	{ __RBRACK__, O_TYPE_NONE, O_TYPE_NONE, O_TYPE_NONE },
	{ __LPAREN__, O_TYPE_NONE, O_TYPE_NONE, O_TYPE_NONE },
	{ __RPAREN__, O_TYPE_NONE, O_TYPE_NONE, O_TYPE_NONE },
	{ __ADD__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __SUB__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __MUL__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __DIV__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __POW__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __MOD__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __LT__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __GT__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __LE__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __GE__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __LSHIFT__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __RSHIFT__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __AND__,
	  O_BR_RESULT_ANY | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __OR__,
	  O_BR_RESULT_ANY | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __EQ__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __CLOSURE__,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE | O_ATTR_MUTABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE | O_ATTR_MUTABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __NE__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __BAND__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __BOR__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __BXOR__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE },
	{ __ASSIGN__,
	  O_BR_RESULT_RIGHT | O_ATTR_MUTABLE | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_MUTABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __SEQUENCE_POINT__,
	  O_BR_RESULT_RIGHT | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __SEQUENCE__,
	  O_TYPE_SEQUENCE | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __SEPARATOR__,
	  O_BR_RESULT_RIGHT | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __ATTRIBUTE__,
	  O_BR_RESULT_LEFT | O_ATTR_MUTABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __LOOP__,
	  O_BR_RESULT_ANY | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __DO__,
	  O_BR_RESULT_LEFT | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __ELSE__,
	  O_BR_RESULT_ANY | O_ATTR_READABLE,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE },
	{ __NOT__,
	  O_TYPE_NUMBER | O_ATTR_READABLE,
	  O_TYPE_UNDEFINED | O_ATTR_READABLE,
	  O_TYPE_NONE },
	{ __START__, O_TYPE_NONE, O_TYPE_NONE, O_TYPE_NONE },
	{ __END__, O_TYPE_NONE, O_TYPE_NONE, O_TYPE_NONE }
};

// Function to get the value associated with an expr_kind
struct op_meta *get_expr_types(enum expr_kind kind)
{
	for (size_t i = 0;
	     i < sizeof(op_meta_lookup) / sizeof(op_meta_lookup[0]);
	     ++i) {
		if (op_meta_lookup[i].kind == kind) {
			return ((struct op_meta *)&op_meta_lookup[i]);
		}
	}
	return (NULL);
}
